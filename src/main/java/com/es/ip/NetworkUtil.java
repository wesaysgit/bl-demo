package com.es.ip;

import org.apache.log4j.Logger;

import javax.servlet.http.HttpServletRequest;
import java.io.IOException;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

public final class NetworkUtil {

    public static void main(String[] args) {
        List<String> lsList = Arrays.asList("21202410121851477457203	", "21202410121801063159110	", "21202410121737237577303	", "21202410121726191718956	", "21202410121724373229342	", "21202410121720163374508	", "21202410121712041613274	", "21202410121647049980136	", "21202410121644225924721	", "21202410121641481880093	", "21202410121640213513870	", "21202410121637547805926	", "21202410121629103480666	", "21202410121622552918170	", "21202410121622241006177	", "21202410121621231796994	", "21202410121616166672832	", "21202410121614216234597	", "212024101216083794493	", "21202410121606522983478	", "21202410121605313349377	", "21202410121605186508050	", "21202410121602361978709	", "21202410121550499790703	", "21202410121548295542874	", "21202410121548034004324	", "21202410121547159703813	", "2120241012154652949668	", "21202410121545588201476	", "21202410121544494994145	", "21202410121543568445337	", "21202410121532542089316	", "21202410121529473396732	", "21202410121527471404738	", "21202410121523432666610	", "21202410121517156692100	", "21202410121516197237562	", "21202410121516153755566	", "21202410121515577284056	", "21202410121508028964388	", "21202410121506345640448	", "21202410121505034748968	", "21202410121502211772942	", "21202410121459575493673	", "21202410121448482778853	", "21202410121441136557907	", "21202410121440014527436	", "21202410121438177238436	", "21202410121436537654197	", "21202410121436189188379	", "21202410121432373174891	", "21202410121423464790268	", "2120241012142150439056	", "21202410121419328050278	", "21202410121412447124815	", "21202410121408379028873	", "21202410121408178299487	", "21202410121405094931835	", "2120241012140456149738	", "21202410121400449910805	", "21202410121359019007566	", "21202410121358425387543	", "21202410121356028133360	", "21202410121355592972803	", "21202410121354267193241	", "21202410121350463462768	", "21202410121348141009901	", "2120241012134038904617	", "21202410121333514386774	", "21202410121331532913468	", "21202410121330334263132	", "21202410121326076459744	", "2120241012132515163779	", "21202410121323525220012	", "21202410121321338122114	", "21202410121316494434623	", "21202410121315572755197	", "21202410121315115028437	", "21202410121314374521052	", "21202410121308171310059	", "21202410121307557044013	", "21202410121304438944310	", "21202410121259521251695	", "21202410121257275055018	", "21202410121248342640621	", "21202410121247164347593	", "2120241012123607762757	", "21202410121234329487075	", "21202410121233351833152	", "21202410121231214631934	", "21202410121228305195527	", "21202410121226328715032	", "21202410121223486262474	", "21202410121221566993839	", "21202410121221446802247	", "21202410121220502415811	", "21202410121214135133312	", "21202410121212543825472	", "21202410121212115456810	", "21202410121211377771256	", "21202410121209315995418	", "2120241012120340903784	", "21202410121202179489398	", "21202410121201355620130	", "2120241012120032983137	", "21202410121159212345663	", "21202410121159115602702	", "2120241012115347808250	", "21202410121149573007843	", "21202410121149545321913	", "21202410121147575626647	", "212024101211471788998	", "21202410121144135620315	", "21202410121143379091087	", "21202410121140287219359	", "21202410121140019161357	", "21202410121139432457402	", "21202410121139334906087	", "21202410121137447390835	", "21202410121137347964003	", "21202410121136189060307	", "21202410121132519649194	", "21202410121131481207358	", "21202410121129344834389	", "21202410121128276250366	", "21202410121127599146254	", "21202410121125128071932	", "21202410121124213820902	", "21202410121124177374009	", "21202410121123468440551	", "21202410121123089012578	", "21202410121122451649726	", "21202410121120095119899	", "21202410121118395560240	", "21202410121117129392357	", "21202410121115526514118	", "21202410121111512792835	", "21202410121108398441638	", "21202410121107271653506	", "21202410121105059762735	", "21202410121056555147885	", "21202410121053037373800	", "21202410121051401474704	", "21202410121047356138428	", "21202410121047268007914	", "21202410121047019750556	", "21202410121040563197651	", "21202410121031185630496	", "21202410121014507375104	", "21202410121014225381519	", "2120241012095745344631	", "21202410120955052145314	", "21202410120952342325100	", "21202410120947483825883	", "2120241012091558603276	", "21202410120855068638251	", "21202410120846393632576	");
        List<String> blList = Arrays.asList("21202410121851477457203", "21202410121801063159110", "21202410121737237577303", "21202410121726191718956", "21202410121724373229342", "21202410121720163374508", "21202410121712041613274", "21202410121647049980136", "21202410121644225924721", "21202410121641481880093", "21202410121640213513870", "21202410121637547805926", "21202410121629103480666", "21202410121622552918170", "21202410121622241006177", "21202410121621231796994", "21202410121616166672832", "21202410121614216234597", "212024101216083794493", "21202410121606522983478", "21202410121605313349377", "21202410121605186508050", "21202410121602361978709", "21202410121550499790703", "21202410121548295542874", "21202410121548034004324", "21202410121547159703813", "2120241012154652949668", "21202410121545588201476", "21202410121544494994145", "21202410121543568445337", "21202410121532542089316", "21202410121529473396732", "21202410121527471404738", "21202410121523432666610", "21202410121517156692100", "21202410121516197237562", "21202410121516153755566", "21202410121515577284056", "21202410121508028964388", "21202410121506345640448", "21202410121505034748968", "21202410121502211772942", "21202410121459575493673", "21202410121448482778853", "21202410121441136557907", "21202410121440014527436", "21202410121438177238436", "21202410121436537654197", "21202410121436189188379", "21202410121432373174891", "21202410121423464790268", "2120241012142150439056", "21202410121419328050278", "21202410121412447124815", "21202410121408379028873", "21202410121408178299487", "21202410121405094931835", "21202410121359019007566", "21202410121358425387543", "21202410121356028133360", "21202410121355592972803", "21202410121354267193241", "21202410121350463462768", "21202410121348141009901", "21202410121347567686246", "2120241012134038904617", "21202410121333514386774", "21202410121331532913468", "21202410121330334263132", "21202410121326076459744", "2120241012132515163779", "21202410121323525220012", "21202410121321338122114", "21202410121316494434623", "21202410121315572755197", "21202410121315115028437", "21202410121314374521052", "21202410121308171310059", "21202410121307557044013", "21202410121304438944310", "21202410121259521251695", "21202410121257275055018", "21202410121248342640621", "21202410121247164347593", "2120241012123607762757", "21202410121234329487075", "21202410121233351833152", "21202410121231214631934", "21202410121228305195527", "21202410121226328715032", "21202410121223486262474", "21202410121221566993839", "21202410121221446802247", "21202410121220502415811", "21202410121214135133312", "21202410121212543825472", "21202410121212115456810", "21202410121211377771256", "21202410121209315995418", "2120241012120340903784", "21202410121202179489398", "21202410121201355620130", "2120241012120032983137", "21202410121159212345663", "21202410121159115602702", "2120241012115347808250", "21202410121149545321913", "21202410121149573007843", "21202410121147575626647", "212024101211471788998", "21202410121144135620315", "21202410121143379091087", "21202410121140287219359", "21202410121140019161357", "21202410121139432457402", "21202410121139334906087", "21202410121137447390835", "21202410121137347964003", "21202410121136189060307", "21202410121132519649194", "21202410121131481207358", "21202410121129344834389", "21202410121128276250366", "21202410121127599146254", "21202410121125128071932", "21202410121124213820902", "21202410121124177374009", "21202410121123468440551", "21202410121123089012578", "21202410121122451649726", "21202410121120095119899", "21202410121118395560240", "21202410121117129392357", "21202410121115526514118", "21202410121111512792835", "21202410121108398441638", "21202410121107271653506", "21202410121105059762735", "21202410121056555147885", "21202410121053037373800", "21202410121051401474704", "21202410121047356138428", "21202410121047268007914", "21202410121047019750556", "21202410121040563197651", "21202410121031185630496", "21202410121014507375104", "21202410121014225381519", "2120241012095745344631", "21202410120955052145314", "21202410120952342325100", "21202410120947483825883", "2120241012091558603276", "21202410120855068638251", "21202410120846393632576", "2120241012140456149738", "21202410121400449910805");
        List<String> collect = lsList.stream().map(String::trim).collect(Collectors.toList());
        for (String s : blList) {
            if (!collect.contains(s)) {
                System.out.println(s);
            }
        }
    }

    /**
     * Logger for this class
     */
    private static Logger logger = Logger.getLogger(NetworkUtil.class);

    public static String getIpAddress(HttpServletRequest request) throws IOException {

        String ip = request.getHeader("X-Forwarded-For");

        if (ip == null || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) {
            if (ip == null || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) {
                ip = request.getHeader("X-Real-IP");
                if (logger.isInfoEnabled()) {
                    logger.info("getIpAddress(HttpServletRequest) - Proxy-Client-IP - String ip=" + ip);
                }
            }
            if (ip == null || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) {
                ip = request.getHeader("Proxy-Client-IP");
                if (logger.isInfoEnabled()) {
                    logger.info("getIpAddress(HttpServletRequest) - Proxy-Client-IP - String ip=" + ip);
                }
            }
            if (ip == null || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) {
                ip = request.getHeader("WL-Proxy-Client-IP");
                if (logger.isInfoEnabled()) {
                    logger.info("getIpAddress(HttpServletRequest) - WL-Proxy-Client-IP - String ip=" + ip);
                }
            }
            if (ip == null || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) {
                ip = request.getHeader("HTTP_CLIENT_IP");
                if (logger.isInfoEnabled()) {
                    logger.info("getIpAddress(HttpServletRequest) - HTTP_CLIENT_IP - String ip=" + ip);
                }
            }
            if (ip == null || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) {
                ip = request.getHeader("HTTP_X_FORWARDED_FOR");
                if (logger.isInfoEnabled()) {
                    logger.info("getIpAddress(HttpServletRequest) - HTTP_X_FORWARDED_FOR - String ip=" + ip);
                }
            }
            if (ip == null || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) {
                ip = request.getRemoteAddr();
                if (logger.isInfoEnabled()) {
                    logger.info("getIpAddress(HttpServletRequest) - getRemoteAddr - String ip=" + ip);
                }
            }
        } else if (ip.length() > 15) {
            String[] ips = ip.split(",");
            for (int index = 0; index < ips.length; index++) {
                String strIp = (String) ips[index];
                if (!("unknown".equalsIgnoreCase(strIp))) {
                    ip = strIp;
                    break;
                }
            }
        }
        return ip;
    }
}
